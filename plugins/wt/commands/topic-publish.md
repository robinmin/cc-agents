---
description: Multi-platform content publishing orchestration
argument-hint: <content-file-or-topic-folder> [--platforms <platform1,platform2>] [--dry-run]
---

# Topic Publish

Publish content to multiple platforms simultaneously using intelligent platform selection and graceful error handling. Supports both individual files and topic folders with multi-language articles.

## Quick Start

```bash
/wt:topic-publish article.md                                    # Single file, auto-select platforms
/wt:topic-publish ~/tcc/repo/collections/my-topic                    # Topic folder, all languages
/wt:topic-publish article.md --platforms medium,substack               # Specify platforms
/wt:topic-publish ~/tcc/repo/collections/my-topic --dry-run          # Preview without publishing
```

## Input Types

This command supports two input types:

### 1. Single File

Direct path to an article file:

```bash
/wt:topic-publish article.md
/wt:topic-publish ~/my-article.md
```

### 2. Topic Folder (from wt:tc-writer)

Path to a topic folder generated by `wt:tc-writer`:

```bash
/wt:topic-publish ~/tcc/repo/collections/overview-of-macos-process-automation-methods
```

**Topic folder structure:**

```
~/tcc/repo/collections/{topic-name}/
├── 0-materials/
├── 1-research/
├── 2-outline/
├── 3-draft/
├── 4-illustration/
├── 5-adaptation/
└── 6-publish/              <-- Articles are here
    ├── article_cn.md       # Chinese version
    ├── article_en.md       # English version
    └── article_ja.md       # Japanese version (optional)
```

When a topic folder is provided:

- Automatically looks for `6-publish/` subfolder
- Discovers all language articles (`article_{lang}.md`)
- Publishes all available language versions
- Maps language codes to appropriate platforms

## Language Mapping

| File Pattern        | Language             | Target Platforms                         |
| ------------------- | -------------------- | ---------------------------------------- |
| `article_cn.md`     | Chinese (Simplified) | Juejin, InfoQ, WeChat MP, XHS            |
| `article_en.md`     | English              | Medium, Surfing, Dev.to, InfoQ, Substack |
| `article_ja.md`     | Japanese             | Qiita, Zenn                              |
| `article_jp.md`     | Japanese             | Qiita, Zenn                              |
| `article_{lang}.md` | Other                | Auto-match based on content              |

## Workflow

This command delegates to the **super-publisher** agent for multi-platform orchestration:

```python
Task(subagent_type="wt:super-publisher",
    prompt="""Publish content to platforms

Content: {content_file_or_folder}
Platforms: {platforms}
Mode: {dry_run}

Steps:

1. Detect input type (file vs folder)

2. Detect if platforms were explicitly specified by user:
   - If {platforms} is provided: SKIP auto-selection and user confirmation
   - If {platforms} is empty: proceed to auto-selection

3. Auto-selection only (when platforms not specified):
   a. Detect language from:
      - File content analysis
      - File path pattern (e.g., article_cn.md → Chinese)
      - Folder name patterns (e.g., {topic-name}/collections/)
   b. Detect category and topic from:
      - File content analysis (tags, subject matter)
      - File path name (e.g., "overview-of-macos-process-automation-methods" → Technical, macOS, Automation)
      - Frontmatter metadata
   c. Match platforms using decision table (category + language based)
   d. Use AskUserQuestion to confirm selected platforms with user

4. Publish sequentially with graceful error handling

5. Generate comprehensive summary report
   """
)
```

## Platform Selection Logic

**Auto-selection considers:**

1. **Content Language** - From file content, filename pattern, or frontmatter
2. **Content Category** - Technical, Newsletter, Social, etc.
3. **Topic/Subject Matter** - From content analysis or filename hints
4. **Platform Requirements** - Character limits, format requirements, audience

**User confirmation:**

| Scenario                       | Behavior                                                                            |
| ------------------------------ | ----------------------------------------------------------------------------------- |
| User specifies `--platforms`   | Skip auto-selection, publish directly to specified platforms                        |
| User doesn't specify platforms | Auto-select based on content + language + category, then AskUserQuestion to confirm |
| User provides topic folder     | Auto-select per article, confirm all platforms for all articles                     |

## Platform Selection

When no platforms specified, the agent uses intelligent selection based on content language:

### Single File Articles

| Content Language     | Content Category | Recommended Platforms           |
| -------------------- | ---------------- | ------------------------------- |
| English              | Technical        | Medium, Surfing (Dev.to), InfoQ |
| Chinese (Simplified) | Technical        | Juejin, InfoQ, WeChat MP, XHS   |
| Japanese             | Technical        | Qiita, Zenn                     |
| Any                  | Newsletter       | Substack                        |
| Any                  | Social           | X (Twitter), XHS                |

### Topic Folder (Multi-Language)

When a topic folder is provided, each language article is routed to its appropriate platforms:

| Article File        | Language             | Auto-Published To              |
| ------------------- | -------------------- | ------------------------------ |
| `article_en.md`     | English              | Medium, Surfing, InfoQ         |
| `article_cn.md`     | Chinese (Simplified) | Juejin, InfoQ, WeChat MP, XHS  |
| `article_ja.md`     | Japanese             | Qiita, Zenn                    |
| `article_{code}.md` | Other                | Auto-detected based on content |

## Supported Platforms

- **Juejin** (掘金) - Chinese technical community
- **Qiita** - Japanese developer community
- **Zenn** - Japanese technical articles
- **Medium** - General tech blogging
- **X (Twitter)** - Microblogging with thread support
- **Substack** - Newsletter publishing
- **InfoQ** - Enterprise software articles
- **WeChat MP** (公众号) - Chinese social media
- **XHS** (小红书) - Chinese social commerce
- **Surfing** - Selfhosted Developer tutorials Website

## Output

After publishing, generates a summary report:

### Single File Example

```
## Multi-Platform Publishing Summary

### Results Overview
- Content: article.md (English)
- Total Platforms: 4
- Successful: 4
- Failed: 0

### Successful Publications
| Platform | URL | Published At |
| -------- | --- | ------------ |
| Medium | https://medium.com/@user/post-id | 2025-01-15 10:30 |
| Surfing | https://surfing.salty.vip/article-title | 2025-01-15 10:31 |
| InfoQ | https://infoq.cn/articles/xxxx | 2025-01-15 10:32 |
```

### Topic Folder Example (Multi-Language)

```
## Multi-Platform Publishing Summary

### Results Overview
- Topic: overview-of-macos-process-automation-methods
- Articles Found: 2 (article_en.md, article_cn.md)
- Total Publications: 8
- Successful: 8
- Failed: 0

### English Article (article_en.md)
| Platform | URL | Published At |
| -------- | --- | ------------ |
| Medium | https://medium.com/@user/post-id | 2025-01-15 10:30 |
| Surfing | https://surfing.salty.vip/article-title | 2025-01-15 10:31 |
| InfoQ | https://infoq.com/articles/xxxx | 2025-01-15 10:32 |

### Chinese Article (article_cn.md)
| Platform | URL | Published At |
| -------- | --- | ------------ |
| Juejin | https://juejin.cn/post/xxxxx | 2025-01-15 10:33 |
| InfoQ | https://infoq.cn/articles/xxxx | 2025-01-15 10:34 |
| WeChat MP | https://mp.weixin.qq.com/s/xxxx | 2025-01-15 10:35 |
| XHS | https://xiaohongshu.com/discovery/item/xxxx | 2025-01-15 10:36 |
```

## Stages

This is Stage 6 of the 7-stage Technical Content Workflow:

- Stage 0: `/wt:info-seek` - Extract materials
- Stage 1: `/wt:info-research` - Conduct research
- Stage 2: `/wt:topic-outline` - Generate outline
- Stage 3: `/wt:topic-draft` - Write draft
- Stage 4: `/wt:topic-illustrate` - Generate illustrations
- Stage 5: `/wt:topic-adapt` - Adapt content
- **Stage 6: `/wt:topic-publish`** - Publish (this command)

## Configuration

Required platform credentials in `~/.claude/wt/config.jsonc`:

```jsonc
{
  "publish-to-medium": {
    "integration_token": "your_medium_token",
  },
  "publish-to-juejin": {
    "cookie": "your_juejin_cookie",
  },
  // ... other platform configs
}
```

## See Also

- **Agent**: `wt:super-publisher` - Full orchestration logic
- **Skills**: `wt:publish-to-*` - Individual platform publishing
- **Documentation**: `plugins/wt/agents/super-publisher.md`

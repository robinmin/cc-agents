---
name: refactor code-generate and tasks-plan and its related components
description: Task: refactor code-generate and tasks-plan and its related components
status: Done
task_type: auto
created_at: 2026-01-26 09:55:24
updated_at: 2026-01-26 15:44:15
impl_progress:
  phase_0_interview:
    status: pending
  phase_1_refinement:
    status: pending
  phase_2_design:
    status: pending
  phase_3_decomposition:
    status: pending
  phase_4_orchestration:
    status: pending
---

## 0086. refactor code-generate and tasks-plan and its related components

### Background

After using slash command `/tasks-plan` a while, I realized that the current implementation was not meeting the requirements. It can not complete the task as expected. Meanwhile, it got complex and hard to maintain and hard to split the responsebility with slash command `/code-generate`

You can refer to my old implementation in `plugins/rd/commands/task-runner.md.disabled`, or refer to the original workfolow in `docs/rd2-workflow.md` which may be changed over time.

Based on above things, we need to align the the responsibility of bundary for each component:

- plugins/rd2/agents/super-planner.md:
- plugins/rd2/agents/super-designer.md:
- plugins/rd2/agents/super-architect.md:
- plugins/rd2/agents/super-coder.md:
- plugins/rd2/commands/tasks-plan.md:
- plugins/rd2/commands/tasks-refine.md:
- plugins/rd2/commands/tasks-design.md:
- plugins/rd2/commands/code-generate.md:
- plugins/rd2/commands/code-review.md:

### Q&A (Interview Phase)

> **Note:** Populated by Phase 0: Interview Phase when clarifying questions are asked and answered. Format:
>
> - **Question:** [User question]
> - **Answer:** [User's answer]
> - **Asked at:** [Timestamp]

[Clarification questions and answers from requirements gathering]

### Requirements / Objectives

#### Architecture Rules for refactoring

- **Fat Skills, Thin Wrappers** principle
- Subagents are the wrappers of Agent Skills, Slash Commands are the wrappers of Subagents aspects.
- Subagents are the core components to implement the details of the workflow, including super-planner, super-designer, super-architect, and super-coder.
- Each subagent should have a clear responsibility boundary. and they always pass information by the task files.
- Task Files and its status are the keys to manage the workflow and determine the next step.

#### Responsibilities for each component

- Slash command `plugins/rd2/commands/tasks-plan.md` manages the whole process via build in tools `SlashCommand` or `Task` to orchestrate the workflow. Never involve into the details of the workflow.
- Slash command `plugins/rd2/commands/tasks-refine.md` responds to refine the requirements and clarify with end user. It will be called by slash command `plugins/rd2/commands/tasks-plan.md` for original requirements or `plugins/rd2/commands/code-generate.md` for those new generated requirements by task decomposition.
- Slash command `plugins/rd2/commands/tasks-design.md` should be designed to complete the design(including architecture design and UI/UX design) phase of the project. And will be called by slash command `plugins/rd2/commands/tasks-plan.md`.
- Slash command `plugins/rd2/commands/code-generate.md` should be designed to implement the coding phase of the project. And will be called by slash command `plugins/rd2/commands/tasks-plan.md` for the original requirements if no further task decomposition is needed or a set of new requirements generated by task decomposition.
- Slash command `plugins/rd2/commands/code-review.md` should be designed to review the code generated by slash command `plugins/rd2/commands/code-generate.md`. And will be called by slash command `plugins/rd2/commands/tasks-plan.md`. Each slash command `plugins/rd2/commands/code-generate.md` must be reviewed by slash command `plugins/rd2/commands/code-review.md`.

### Solutions / Goals

> **Note:** Specialist outputs (super-architect, super-designer) are added here with attribution:
>
> - Specialist name
> - Completion date
> - Artifacts generated (with file paths)

[Implementation notes, approach, or solutions]

### Artifacts

> **Note:** Track all generated files from specialists and implementation:
>
> - Architecture specs, diagrams, design mockups
> - Implementation files (code, configs, tests)
> - Documentation updates

| Type | Path | Generated By | Date | Purpose |
| ---- | ---- | ------------ | ---- | ------- |
|      |      |              |      |         |

### References

> **Note:** Include external documentation links AND links to specialist outputs:
>
> - External docs: [Title](URL)
> - Specialist outputs: [Title](relative/path) - by specialist

[Links, resources, or related documentation]

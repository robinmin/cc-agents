---
name: enhance-tasks-create-with-rich-content-and-validation
description: "Phase 1b: Enhance tasks create with rich content injection, tiered validation, and status transition gates"
status: Done
created_at: 2026-02-09 16:13:36
updated_at: 2026-02-10 09:03:13
impl_progress:
  planning: completed
  design: completed
  implementation: completed
  review: completed
  testing: completed
dependencies: [0180]
tags: [tasks-enhancement, validation, infrastructure]
---

## 0181. enhance-tasks-create-with-rich-content-and-validation

### Background

Agents frequently create skeleton-only task files using `tasks create` — files with template placeholders but no actual Background or Requirements content. This defeats the purpose of task-file-centric workflow because the task files lack the context needed for downstream agents to execute.

Additionally, there are no validation gates on status transitions. An agent can mark a task as "Done" even when required sections are empty. The `tasks update` command needs tiered validation to enforce quality standards.

### Requirements

**Functional Requirements:**

1. **Rich `tasks create`** - Accept structured content at creation time:
   - `--background "context text"` — Inject Background section content
   - `--requirements "requirements text"` — Inject Requirements section content
   - `--from-json <file>` — Create from JSON structure with all fields
   - `--from-stdin` — Read JSON from stdin (for piping from agent output)
   - Backward compatible: bare `tasks create "name"` still works with template

2. **Tiered validation on status transitions**:
   - **Tier 1 (Errors - block always)**: Missing frontmatter, invalid status value, invalid WBS format
   - **Tier 2 (Warnings - block status transitions)**: Empty Background when moving to WIP, empty Requirements when moving to WIP, empty Plan when moving to Testing
   - **Tier 3 (Suggestions - informational)**: Missing References, missing Q&A, empty Artifacts table
   - `--force` flag to bypass Tier 2 warnings

3. **Enhanced `tasks check` command**:
   - Run validation on a single task or all tasks
   - Report tier breakdown: X errors, Y warnings, Z suggestions
   - Return non-zero exit code if errors found

**Acceptance Criteria:**
- [ ] `tasks create "name" --background "..." --requirements "..."` creates populated task
- [ ] `tasks create --from-json file.json` creates task from JSON input
- [ ] `tasks update 0180 wip` fails if Background section is empty (Tier 2)
- [ ] `tasks update 0180 wip --force` bypasses Tier 2 warning
- [ ] `tasks check 0180` reports validation results with tier breakdown
- [ ] `tasks check` (no args) validates all tasks
- [ ] All existing functionality preserved (backward compatible)

### Q&A

**Q:** What JSON format for `--from-json`?
**A:** Match the task template structure:
```json
{
  "name": "task-name",
  "description": "brief description",
  "background": "Context and motivation",
  "requirements": "What needs to be done",
  "tags": ["tag1", "tag2"]
}
```

**Q:** Should validation block `tasks create` or only `tasks update`?
**A:** Only `tasks update` for status transitions. `tasks create` should always succeed (skeleton is valid for Backlog status).

### Design

[Architecture/UI specs added by specialists]

### Plan

1. **Enhance `tasks create` command**
   - [ ] Add `--background`, `--requirements`, `--tags` CLI arguments
   - [ ] Add `--from-json` file input parsing
   - [ ] Add `--from-stdin` support for piped input
   - [ ] Update template rendering to inject provided content
   - [ ] Preserve backward compatibility for bare `tasks create "name"`

2. **Implement tiered validation engine**
   - [ ] Create `ValidationResult` class with tiers (error, warning, suggestion)
   - [ ] Implement section content validators (is_empty, has_placeholder_only)
   - [ ] Define validation rules per status transition
   - [ ] Add `--force` flag to bypass Tier 2

3. **Enhance `tasks update` with validation gates**
   - [ ] Before status change, run tier validation
   - [ ] Block on Tier 1 errors (always)
   - [ ] Block on Tier 2 warnings (unless --force)
   - [ ] Report Tier 3 suggestions (informational)

4. **Enhance `tasks check` command**
   - [ ] Accept optional WBS argument (single task or all)
   - [ ] Run full validation and report by tier
   - [ ] Return appropriate exit codes

5. **Test and document**
   - [ ] Unit tests for validation engine
   - [ ] Integration tests for CLI arguments
   - [ ] Update SKILL.md documentation

### Artifacts

| Type | Path | Generated By | Date |
|------|------|--------------|------|

### References

- tasks.py: `plugins/rd2/skills/tasks/scripts/tasks.py`
- Task template: `plugins/rd2/skills/tasks/assets/.template.md`
- Related: 0180 (WBS bug fix - must complete first)

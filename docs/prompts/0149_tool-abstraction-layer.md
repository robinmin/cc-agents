---
wbs: "0003"
topic: "rd2:tasks Agent Skill Upgrade"
description: "Create ToolSelector and adapters for TaskList, TaskGet, TaskUpdate, and TodoWrite"
status: Backlog
created_at: "2026-02-02"
updated_at: "2026-02-02"
impl_progress:
  planning: pending
  design: pending
  implementation: pending
  review: pending
  testing: pending
---

## 0149. Tool Abstraction Layer Implementation

### Background

The `rd2:tasks` agent skill currently relies solely on Claude Code's `TodoWrite` tool for all task management operations. To support the new Task tools (TaskList, TaskGet, TaskUpdate) introduced in Claude Code v2.1.16+, we need an abstraction layer that:

1. Abstracts the underlying tool implementation details from the rest of the application
2. Allows seamless switching between legacy (TodoWrite) and new (Task\*) tools
3. Provides a consistent interface regardless of which tool is being used
4. Enables auto-detection and fallback for backward compatibility

This is the foundational component that all other tasks depend on. Without it, we cannot properly integrate the new task management capabilities.

### Requirements

1. **ToolSelector Class**: Implement a selector that determines which tool adapter to use based on availability
2. **ToolAdapter Interface**: Define a common interface that all adapters must implement:
   - `isAvailable(): Promise<boolean>` - Check if the tool is available
   - `listTasks(): Promise<Task[]>` - List all tasks
   - `getTask(id: string): Promise<Task | null>` - Get single task
   - `updateTask(id: string, updates: TaskUpdates): Promise<Task>` - Update task
   - `deleteTask(id: string): Promise<void>` - Delete task
3. **Adapter Implementations**: Create adapters for:
   - TodoWriteAdapter (legacy fallback)
   - TaskListAdapter (new tool)
   - TaskGetAdapter (new tool)
   - TaskUpdateAdapter (new tool)
4. **Configuration**: Support configuration for preferred tool selection
5. **Error Handling**: Unified error handling across all adapters

### Q&A

[Clarifications to be added during planning phase]

### Design

[Architecture specs to be added by specialists]

### Plan

1. Define ToolAdapter interface with TypeScript types
2. Implement ToolSelector with availability checking
3. Create TodoWriteAdapter as reference implementation
4. Implement TaskListAdapter
5. Implement TaskGetAdapter
6. Implement TaskUpdateAdapter
7. Add unit tests for all adapters
8. Test adapter selection logic

### Artifacts

| Type | Path | Generated By | Date |
| ---- | ---- | ------------ | ---- |

### References

- [Master Task: 0001_rd2-tasks-upgrade.md](/docs/prompts/0001_rd2-tasks-upgrade.md)
- [Claude Code SDK - Todo Tracking](https://docs.claude.com/en/docs/claude-code/sdk/todo-tracking)
